
#
# XPLD plasma+sprites demo
# (c) friol 2k20
#

sinTable db 128, 130, 132, 135, 137, 140, 142, 145, 147, 150, 152, 155, 157, 160, 162, 164, 167, 169, 171, 174, 176, 178, 181, 183, 185, 187, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 217, 219, 221, 222, 224, 226, 227, 229, 230, 232, 233, 234, 236, 237, 238, 240, 241, 242, 243, 244, 245, 246, 247, 247, 248, 249, 250, 250, 251, 252, 252, 253, 253, 253, 254, 254, 254, 254, 254, 254, 255, 254, 254, 254, 254, 254, 254, 253, 253, 253, 252, 252, 251, 250, 250, 249, 248, 247, 247, 246, 245, 244, 243, 242, 241, 240, 238, 237, 236, 234, 233, 232, 230, 229, 227, 226, 224, 222, 221, 219, 217, 216, 214, 212, 210, 208, 206, 204, 202, 200, 198, 196, 194, 192, 190, 187, 185, 183, 181, 178, 176, 174, 171, 169, 167, 164, 162, 160, 157, 155, 152, 150, 147, 145, 142, 140, 137, 135, 132, 130, 128, 125, 123, 120, 118, 115, 113, 110, 108, 105, 103, 100, 98, 95, 93, 91, 88, 86, 84, 81, 79, 77, 74, 72, 70, 68, 65, 63, 61, 59, 57, 55, 53, 51, 49, 47, 45, 43, 41, 39, 38, 36, 34, 33, 31, 29, 28, 26, 25, 23, 22, 21, 19, 18, 17, 15, 14, 13, 12, 11, 10, 9, 8, 8, 7, 6, 5, 5, 4, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 4, 5, 5, 6, 7, 8, 8, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 21, 22, 23, 25, 26, 28, 29, 31, 33, 34, 36, 38, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 68, 70, 72, 74, 77, 79, 81, 84, 86, 88, 91, 93, 95, 98, 100, 103, 105, 108, 110, 113, 115, 118, 120, 123, 125
sinTable256 db 128, 131, 134, 137, 140, 143, 146, 149, 152, 155, 158, 161, 164, 167, 170, 173, 176, 179, 182, 185, 187, 190, 193, 195, 198, 201, 203, 206, 208, 210, 213, 215, 217, 219, 222, 224, 226, 228, 230, 231, 233, 235, 236, 238, 240, 241, 242, 244, 245, 246, 247, 248, 249, 250, 251, 251, 252, 253, 253, 254, 254, 254, 254, 254, 255, 254, 254, 254, 254, 254, 253, 253, 252, 251, 251, 250, 249, 248, 247, 246, 245, 244, 242, 241, 240, 238, 236, 235, 233, 231, 230, 228, 226, 224, 222, 219, 217, 215, 213, 210, 208, 206, 203, 201, 198, 195, 193, 190, 187, 185, 182, 179, 176, 173, 170, 167, 164, 161, 158, 155, 152, 149, 146, 143, 140, 137, 134, 131, 128, 124, 121, 118, 115, 112, 109, 106, 103, 100, 97, 94, 91, 88, 85, 82, 79, 76, 73, 70, 68, 65, 62, 60, 57, 54, 52, 49, 47, 45, 42, 40, 38, 36, 33, 31, 29, 27, 25, 24, 22, 20, 19, 17, 15, 14, 13, 11, 10, 9, 8, 7, 6, 5, 4, 4, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 3, 4, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 17, 19, 20, 22, 24, 25, 27, 29, 31, 33, 36, 38, 40, 42, 45, 47, 49, 52, 54, 57, 60, 62, 65, 68, 70, 73, 76, 79, 82, 85, 88, 91, 94, 97, 100, 103, 106, 109, 112, 115, 118, 121, 124
xpldLogoData db 63, 255, 255, 192, 0, 63, 255, 254, 0, 255, 255, 255, 255, 255, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 192, 0, 0, 31, 255, 255, 224, 0, 63, 255, 254, 0, 255, 255, 255, 255, 255, 224, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 248, 0, 0, 31, 255, 255, 224, 0, 63, 255, 254, 0, 255, 255, 255, 255, 255, 248, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 254, 0, 0, 15, 255, 255, 240, 0, 127, 255, 254, 0, 255, 255, 255, 255, 255, 252, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 128, 0, 15, 255, 255, 240, 0, 127, 255, 252, 0, 255, 255, 255, 255, 255, 255, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 224, 0, 7, 255, 255, 240, 0, 255, 255, 248, 0, 255, 255, 255, 255, 255, 255, 128, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 248, 0, 7, 255, 255, 240, 0, 255, 255, 248, 0, 255, 255, 255, 255, 255, 255, 192, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 252, 0, 7, 255, 255, 240, 0, 255, 255, 248, 0, 255, 255, 255, 255, 255, 255, 224, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 254, 0, 3, 255, 255, 248, 0, 255, 255, 248, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 0, 3, 255, 255, 248, 1, 255, 255, 240, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 128, 1, 255, 255, 248, 1, 255, 255, 224, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 192, 0, 255, 255, 252, 3, 255, 255, 192, 0, 255, 255, 255, 255, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 224, 0, 127, 255, 252, 7, 255, 255, 128, 0, 255, 255, 255, 255, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 224, 0, 127, 255, 254, 7, 255, 255, 128, 0, 255, 255, 255, 255, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 240, 0, 63, 255, 254, 7, 255, 255, 128, 0, 255, 255, 240, 7, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 255, 255, 255, 255, 255, 240, 0, 63, 255, 255, 15, 255, 255, 128, 0, 255, 255, 240, 1, 255, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 7, 255, 255, 255, 248, 0, 31, 255, 255, 15, 255, 255, 0, 0, 255, 255, 240, 0, 255, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 31, 255, 255, 248, 0, 31, 255, 255, 31, 255, 254, 0, 0, 255, 255, 240, 0, 255, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 31, 255, 255, 252, 0, 15, 255, 255, 159, 255, 254, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 7, 255, 255, 252, 0, 15, 255, 255, 191, 255, 252, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 3, 255, 255, 252, 0, 7, 255, 255, 255, 255, 252, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 1, 255, 255, 254, 0, 7, 255, 255, 255, 255, 248, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 1, 255, 255, 254, 0, 3, 255, 255, 255, 255, 240, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 255, 255, 254, 0, 1, 255, 255, 255, 255, 224, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 255, 255, 255, 0, 1, 255, 255, 255, 255, 224, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 254, 0, 0, 255, 255, 255, 255, 224, 0, 0, 255, 255, 240, 0, 127, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 255, 0, 0, 255, 255, 255, 255, 192, 0, 0, 255, 255, 240, 0, 255, 255, 252, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 255, 0, 0, 127, 255, 255, 255, 128, 0, 0, 255, 255, 240, 1, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 127, 255, 255, 255, 128, 0, 0, 255, 255, 240, 1, 255, 255, 248, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 63, 255, 255, 255, 0, 0, 0, 255, 255, 240, 15, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 63, 255, 255, 255, 0, 0, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 31, 255, 255, 254, 0, 0, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 31, 255, 255, 254, 0, 0, 0, 255, 255, 255, 255, 255, 255, 240, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 31, 255, 255, 255, 0, 0, 0, 255, 255, 255, 255, 255, 255, 224, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 63, 255, 255, 255, 0, 0, 0, 255, 255, 255, 255, 255, 255, 192, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 63, 255, 255, 255, 128, 0, 0, 255, 255, 255, 255, 255, 255, 128, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 127, 255, 255, 255, 128, 0, 0, 255, 255, 255, 255, 255, 255, 128, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 127, 255, 255, 255, 192, 0, 0, 255, 255, 255, 255, 255, 255, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 63, 255, 255, 0, 0, 255, 255, 255, 255, 224, 0, 0, 255, 255, 255, 255, 255, 252, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 255, 0, 1, 255, 255, 255, 255, 224, 0, 0, 255, 255, 255, 255, 255, 240, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 254, 0, 1, 255, 255, 255, 255, 240, 0, 0, 255, 255, 255, 255, 255, 224, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 127, 255, 254, 0, 3, 255, 255, 255, 255, 240, 0, 0, 255, 255, 255, 255, 255, 128, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 255, 255, 254, 0, 3, 255, 255, 255, 255, 248, 0, 0, 255, 255, 255, 255, 254, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 255, 255, 254, 0, 7, 255, 255, 191, 255, 248, 0, 0, 255, 255, 255, 255, 248, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 0, 255, 255, 252, 0, 15, 255, 255, 63, 255, 252, 0, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 3, 255, 255, 252, 0, 31, 255, 255, 63, 255, 254, 0, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 3, 255, 255, 248, 0, 31, 255, 254, 63, 255, 254, 0, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 15, 255, 255, 248, 0, 31, 255, 254, 63, 255, 255, 0, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 31, 255, 255, 248, 0, 63, 255, 254, 63, 255, 255, 128, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 224, 0, 0, 0, 127, 255, 248, 0, 63, 255, 255, 240, 0, 127, 255, 252, 31, 255, 255, 128, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 224, 0, 127, 255, 252, 15, 255, 255, 192, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 192, 0, 255, 255, 248, 15, 255, 255, 192, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 192, 1, 255, 255, 248, 7, 255, 255, 224, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 192, 1, 255, 255, 240, 7, 255, 255, 224, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 128, 3, 255, 255, 240, 3, 255, 255, 240, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 255, 128, 7, 255, 255, 240, 1, 255, 255, 248, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 254, 0, 7, 255, 255, 240, 1, 255, 255, 248, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 248, 0, 7, 255, 255, 224, 0, 255, 255, 248, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 248, 0, 15, 255, 255, 224, 0, 255, 255, 252, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 240, 0, 15, 255, 255, 192, 0, 255, 255, 252, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 224, 0, 63, 255, 255, 192, 0, 255, 255, 254, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 255, 0, 0, 63, 255, 255, 128, 0, 127, 255, 254, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 252, 0, 0, 127, 255, 255, 128, 0, 127, 255, 255, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 248, 0, 0, 255, 255, 255, 0, 0, 63, 255, 255, 0, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 192, 0, 0, 255, 255, 255, 0, 0, 63, 255, 255, 128, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 255, 0, 0, 0, 255, 255, 254, 0, 0, 31, 255, 255, 128, 255, 255, 240, 0, 0, 0, 0, 3, 255, 255, 255, 255, 255, 192, 127, 255, 255, 255, 224, 0, 0, 0
xpldStarData db 1, 128, 3, 192, 3, 192, 7, 224, 255, 255, 255, 255, 127, 254, 63, 252, 31, 248, 31, 248, 63, 252, 63, 252, 127, 254, 126, 126, 248, 31, 224, 7

systemBootMsg01 ds "xpld v0.1 system boot (c) friol 2o2o"
systemBootMsg02 ds "32k RAM system"
readyPrompt ds "READY."

ld r0,1
ld r1,1
ld r2,10
ld r3,10
@@loadAnotherStar:
jsr loadStarSprite
add r0,1
add r1,1

add r2,20
add r3,16

cmp r0,16
jnz @@loadAnotherStar

jsr loadSprite0
jsr genPallete0
jsr oldSkoolPlasma

jmp @@main

#
# sub: output 0-terminated string to mode0 videomode
# r0: ptr to string
# r1: row
# r2: col
#

.outputStringMode0:
ld r4,0x10000000
add r4,r2
mul r1,40
add r4,r1
@@printstring:
ld8 r3,[r0]
cmp r3,0
jnz @@printinner
rts
@@printinner:
sub r3,0x20
ld8 [r4],r3
add r0,1
add r4,1
jmp @@printstring

#
# generate palette
#

.genPallete0:

ld r0,0
ld r5,sinTable256
ld r7,sinTable256

@@paletteCycle:
ld8 [0x20000002],r0

ld8 r1,[r5]

ld r6,r0
add r6,16
and r6,0xff
add r6,r7

ld8 r2,[r6]
mul r2,256

ld r6,r0
add r6,32
and r6,0xff
add r6,r7

ld8 r3,[r6]
mul r3,65536

add r3,r2
add r3,r1

ld r4,0x20000003
ld32 [r4],r3

add r5,1
add r0,1
cmp r0,256
jnz @@paletteCycle

rts

#
# load sprite 0 with xpld logo
#

.loadSprite0:

ld8 [0x20000100],1
ld8 [0x20000101],248
ld8 [0x20000102],66
ld32 [0x20000104],36
ld32 [0x20000108],78
ld8 [0x20000118],12

ld r0,2046
ld r1,xpldLogoData
@@fetchSpriteData:
ld8 r2,[r1]
ld8 [0x20000112],r2
add r1,1
sub r0,1
cmp r0,0
jnz @@fetchSpriteData
rts

#
# the oldskewl plasma effect
#

.oldSkoolPlasma:

ld r0,sinTable
ld r5,0
ld r8,0
ld r1,sinTable
ld r6,0
ld r2,0x11000000
ld r3,0
ld r12,0
ld r13,0
ld r4,0
ld r7,0
ld r14,0

@@writeInner:
ld r0,sinTable
ld r9,r5
add r9,r8
mod r9,320
add r9,r0
ld8 r4,[r9]
ld8 r7,[r1]
add r4,r7
add r4,r3
and r4,0xff
ld8 [r2],r4
add r2,1
add r0,1
add r5,1
cmp r5,320
jnz @@writeInner

ld r0,sinTable
ld r5,0

add r1,1
add r6,1
cmp r6,240
jnz @@writeInner

# update sprites pos
add r14,1
and r14,0xff
jsr updateSpritesPos

add r8,1
add r12,1

add r3,8
and r3,0xff

ld r0,sinTable
ld r5,0
ld r1,sinTable
ld r6,0
ld r2,0x11000000
jmp @@writeInner

rts

#
# load sprite with star image
# r0=sprite number
# r1=sprite color
# r2=posx
# r3=posy
#

.loadStarSprite:

push r0
push r1
push r2
push r3

ld r4,0x100
mul r4,r0
add r4,0x20000100

ld8 [r4],1
add r4,1
ld8 [r4],16
add r4,1
ld8 [r4],16
add r4,2
ld32 [r4],r2
add r4,4
ld32 [r4],r3
add r4,0x10
ld8 [r4],r1
sub r4,6

ld r0,32
ld r1,xpldStarData

@@fetchCycle:
ld8 r2,[r1]

ld8 [r4],r2
add r1,1
sub r0,1
cmp r0,0
jnz @@fetchCycle

pop r3
pop r2
pop r1
pop r0

rts

#
# upd starts
# r14=pos
#

.updateSpritesPos:

push r0
push r1
push r2
push r3
push r4
push r5
push r6
push r7

ld r7,sinTable256

ld r0,r14

ld r6,r14
add r6,64
and r6,0xff

ld r1,1

@@updSpri:

ld r4,0x100
mul r4,r1
add r4,0x20000104
add r0,r7
ld8 r3,[r0]
add r3,32
sub r0,r7
ld32 [r4],r3
add r4,4
add r6,r7
ld8 r3,[r6]
sub r6,r7
ld32 [r4],r3

add r1,1

add r0,16
and r0,0xff
add r6,16
and r6,0xff

cmp r1,16
jnz @@updSpri

pop r7
pop r6
pop r5
pop r4
pop r3
pop r2
pop r1
pop r0

rts


#
# videoram test/countdown
#

@@fillTest:

ld8 [0x20000001],0

ld r0,0x13
ld r1,0
ld r2,0x10000000

@@fillScreenCycle:
ld8 [r2],r0
add r1,1
add r2,1
cmp r1,1200
jnz @@fillScreenCycle
ld r1,0
ld r2,0x10000000
sub r0,1
cmp r0,0x10
jnz @@fillScreenCycle

ld r0,0
ld r1,0
ld r2,0x10000000
@@fillScreenCycle2:
ld8 [r2],r0
add r1,1
add r2,1
cmp r1,1200
jnz @@fillScreenCycle2

#
# system check routines
#

@@systemCheck:

nop
#ld r0,1234
#ld r1,0xcafebabe
#ld r3,0xffff
#ld r4,42
#ld r2,r3
#ld r4,[0x10000000]
#ld r7,r4

#ld r0,0
#ld32 [0x10000000],r0

@@RAMTest:

ld r0,0x500000
ld r1,42
ld8 [r0],r1
ld8 r2,[0x500000]
cmp r2,42
jnz @@errorHalt

@@main:
ld8 [0x20000001],0

ld r0,systemBootMsg01
ld r1,0
ld r2,0
jsr outputStringMode0

ld r0,systemBootMsg02
ld r1,1
ld r2,0
jsr outputStringMode0

ld r0,readyPrompt
ld r1,3
ld r2,0
jsr outputStringMode0

hlt
